---
title: Github开发规范文档及计划
tags: 新建,模板,小书匠
grammar_cjkRuby: true
---


欢迎使用 **{小书匠}(xiaoshujiang)编辑器**，您可以通过==设置==里的修改模板来改变新建文章的内容。
## 项目结构
项目分为了四个层级：模型层、接口层、核心层、界面层。模型层定义了所有的模型；接口层封装了服务器提供的API；核心层处理所有业务逻辑；界面层就处理界面的展示。

1.模型层：
模型层横跨所有层级，封装了所有数据实体类，基本上也是跟json的obj数据一致的，在核心层会将obj转化为相应的实体类，再通过Subscriber<T> subscriber传到界面层。

2.接口层：
接口层封装了网络底层的API，并提供给核心层调用。每个属性名称都要与json数据对应的名称相一致，否则无法转化。
接口层定义如下：
```java

/**
 * Created by shenjianlis on 2016/8/31.
 */
public interface TestApi {

    @GET("shenjianli/test")
    Observable<HttpResult<TestData>> getTestData(@Query("id") String id);
}
```
3.核心层：
核心层介于接口层和界面层之间，主要处理业务逻辑，集中做数据处理。向上，给界面层提供数据处理的接口，称为Action；向下，调用接口层向服务器请求数据。向上的Action中定义的方法类似如下：
```java
public void getTestData(Subscriber<TestData> subscriber, String id);
```
这是一个获取测试数据的方法，因为需要向接口层请求服务器Api数据，所以添加了callback监听器，在callback里对返回的数据结果进行操作。
接口的实现基本分为两步：

（1）参数检查，检查参数的合法性，包括非空检查、边界检查、有效性检查等；
（2）使用异步任务调用接口层的Api，返回响应结果。
需要注意的是，Action是面向界面的，界面上的数据可能需要根据不同情况调用不同的Api。
后续扩展可以在这里添加缓存，但也要视不同情况而定，比如有些变化太快的数据，添加缓存就不太适合了。
4.界面层：
界面层处于最上层，其核心就是负责界面的展示。
因为公司有为不同商户定制不同app的需求，因此，这里就需要建立多个app的界面，这是一个很麻烦的事情，还好，Android Studio提供了很方便的方法可以大大减少工作量，主要通过设置Gradle，不同app可以添加不同的productFlavors。
界面层package的定义我也并不按照旧版的功能模块划分，而根据不同类型划分，主要分为以下几个包：

其中，activity、adapter、fragment各自都有一个基类，做统一的处理，比如定义了一些共用的常量、对象和方法等。
界面层是最复杂，最容易变得混乱不堪，最容易出问题的层级。所以，从架构到代码，很多东西都需要设计好，以及规范好，才能保证程序易维护、易扩展。
要规划好界面层，至少应该遵循几条基本的原则：

1.保持规范性：定义好开发规范，包括书写规范、命名规范、注释规范等，并按照规范严格执行；
2.保持单一性：布局就只做布局，内容就只做内容，各自分离好，每个方法、每个类，也只做一件事情；
3.保持简洁性：保持代码和结构的简洁，每个方法，每个类，每个包，每个文件，都不要塞太多代码或资源，感觉多了就应该拆分。

资源文件的单一

Android提供了各种资源文件，strings.xml用来存储字符串，arrays.xml用来存储字符串数组，colors.xml用来存储颜色值，dimens.xml用来存储尺寸值，等等。资源文件的单一，是说所有相关的资源信息要在资源文件里定义并引用到代码或布局文件里，而不是在代码或布局文件里直接定义。很多开发人员，为了图方便，应用界面中出现的字符串经常在代码或布局文件里直接定义的，尺寸值也是，这样造成的结果就是，当某些字符串需要修改时，比如要支持国际化，或一些尺寸值需要修改时，通常是很多地方都要修改。因此，就必须规范好，应用界面中的字符串统一在strings.xml中定义，颜色值统一在colors.xml中定义，尺寸值统一在dimens.xml中定义，代码或布局里需要用到的都去引用资源文件相应的字段。

资源文件的分类

strings.xml文件用来存储应用中的所有字符串，包括页面标题，按钮文字，标签文字，提示文字等等，应该做好分类并统一存放。下面是我推荐的分类方法，如果某个分类的字符串数量太多了，还可以拆分出来放到一个独立的文件，比如页面标题，可以拆分到strings_title.xml文件里，其他资源文件也可以用类似的方式进行处理：

页面标题，命名格式为：title_{页面}
按钮文字，命名格式为：btn_{按钮事件}
标签文字，命名格式为：label_{标签文字}
选项卡文字，命名格式为：tab_{选项卡文字}
消息框文字，命名格式为：toast_{消息}
编辑框的提示文字，命名格式为：hint_{提示信息}
图片的描述文字，命名格式为：desc_{图片文字}
对话框的文字，命名格式为：dialog_{文字}

## 网络请求数据格式

主要包括
请求状态(status)：  表示请求数据成功与否的状态，0表示失败，非0 (一般为1) 其他表示成功
错误码(errNo)：  错误发生的代码编号，如 101 ， 200， 203等
错误信息(errMsg)：错误发生的具体内容，如，登录信息过期，请求参数非法，请求时效性过期等
Json数据（data)：表求请求的真正数据体，如，用户信息---User  


附：
错误码  | 错误信息
------------- | -------------
100 | 登录信息过期
101| 请求参数非法
